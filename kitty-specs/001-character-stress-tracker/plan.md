# Implementation Plan: Character Stress Tracker
*Path: [kitty-specs/001-character-stress-tracker/plan.md](kitty-specs/001-character-stress-tracker/plan.md)*

**Branch**: `001-character-stress-tracker` | **Date**: 2025-11-19 | **Spec**: [spec.md](spec.md)
**Input**: Feature specification from `/kitty-specs/001-character-stress-tracker/spec.md`

## Summary

Build a single-page Vue 3 application for tracking character stress in the Alien RPG. Players enter a character name, manipulate stress levels with +/-/reset controls, view an optional action history log, and switch between French/English languages. All data persists locally via localStorage with no backend dependencies. The interface must be responsive (mobile/tablet/desktop) and themed with SF/Alien aesthetics (dark, industrial, futuristic).

## Technical Context

**Language/Version**: TypeScript ~5.9.0
**Primary Dependencies**: Vue 3 (^3.5.22), Tailwind CSS 4 (^4.1.17), vue-i18n (^11.1.12)
**Storage**: Browser localStorage for character state and language preference
**Testing**: Vitest (^3.2.4), @vue/test-utils (^2.4.6), jsdom (^27.0.1)
**Target Platform**: Modern web browsers (ES2020+), mobile-first responsive design
**Project Type**: Single-page application (no routing required)
**Performance Goals**: UI interactions <100ms response, initial load <3s on 3G, bundle <500KB gzipped
**Constraints**: Fully offline-capable, local-first architecture, WCAG 2.1 AA accessibility
**Scale/Scope**: Single-user local application, one character tracked at a time, session-scoped action logs

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

### I. Local-First Architecture ✅ PASS
- **Requirement**: All data stored locally, no remote servers
- **Compliance**: Character state and language preference persist via localStorage. Action log is session-only (in-memory). Zero backend dependencies.
- **Evidence**: FR-008, FR-018 specify localStorage persistence

### II. Responsive Design (NON-NEGOTIABLE) ✅ PASS
- **Requirement**: Mobile-first, tested at 320px, 768px, 1024px+ breakpoints
- **Compliance**: Tailwind 4 utility-first approach with responsive modifiers. Single-page layout adapts to all viewports.
- **Evidence**: FR-014, SC-004 mandate full responsiveness across mobile/tablet/desktop

### III. Internationalization First ✅ PASS
- **Requirement**: French/English via vue-i18n, no hard-coded strings
- **Compliance**: vue-i18n integration, language selector with persistent preference, all UI text externalized
- **Evidence**: FR-015, FR-016, FR-017, FR-018, SC-005

### IV. Component-Driven Development ✅ PASS
- **Requirement**: Reusable Vue 3 Composition API components, clear props/events
- **Compliance**: Main tracker component + action log component, composables for state management and persistence
- **Evidence**: Vue 3 Composition API with `<script setup>`, component separation of concerns

### V. Type Safety ✅ PASS
- **Requirement**: TypeScript throughout, explicit type annotations, type-check passes
- **Compliance**: All components and composables use TypeScript with explicit types. `type-check` script gates completion.
- **Evidence**: Constitution mandates TypeScript ~5.9.0, no `any` without justification

### Technical Standards Compliance ✅ PASS
- **Technology Stack**: Vue 3, Tailwind 4, TypeScript, vue-i18n, Vite - all aligned with constitution
- **Performance**: <100ms UI response (SC-002, SC-008), <3s load, <500KB bundle (constitution standards)
- **Code Organization**: `src/` structure with components/, composables/, i18n/ follows constitution naming conventions
- **Testing**: Vitest + @vue/test-utils for composable and component tests

**GATE STATUS**: ✅ **PASSED** - All constitutional principles satisfied. No violations to justify.

## Project Structure

### Documentation (this feature)

```
kitty-specs/001-character-stress-tracker/
├── spec.md              # Feature specification (completed)
├── plan.md              # This file
├── research.md          # Phase 0 research findings
├── data-model.md        # Phase 1 data model
├── quickstart.md        # Phase 1 user quick-start
├── contracts/           # Phase 1 TypeScript interfaces
│   └── types.ts         # Core type definitions
├── checklists/          # Quality checklists
│   └── requirements.md  # Spec quality checklist (completed)
└── tasks.md             # Phase 2 work packages (generated by /spec-kitty.tasks)
```

### Source Code (repository root)

```
src/
├── components/
│   ├── StressTracker.vue       # Main tracker UI component
│   ├── ActionLog.vue           # Collapsible action history
│   └── LanguageSelector.vue    # French/English switcher
├── composables/
│   ├── useLocalStorage.ts      # Generic localStorage persistence
│   ├── useCharacterState.ts    # Character name + stress state
│   ├── useActionLog.ts         # Session-scoped action history
│   └── useI18n.ts              # i18n setup and utilities
├── i18n/
│   ├── index.ts                # i18n configuration
│   ├── locales/
│   │   ├── en.json             # English translations
│   │   └── fr.json             # French translations
│   └── types.ts                # Translation key types
├── types/
│   └── index.ts                # Shared TypeScript types
├── App.vue                     # Root application component
├── main.ts                     # Application entry point
└── style.css                   # Tailwind imports + global styles

tests/
├── unit/
│   ├── useLocalStorage.spec.ts
│   ├── useCharacterState.spec.ts
│   └── useActionLog.spec.ts
└── components/
    ├── StressTracker.spec.ts
    ├── ActionLog.spec.ts
    └── LanguageSelector.spec.ts

public/
└── (static assets if needed for SF/Alien theming)
```

**Structure Decision**: Single-page application using Vue 3 SFC architecture. No router needed as entire feature fits on one view. Composables encapsulate business logic and localStorage interactions for testability. Component hierarchy: `App.vue` → `StressTracker.vue` + `LanguageSelector.vue`, with `ActionLog.vue` as a child of `StressTracker.vue`. This structure aligns with Vue 3 best practices and constitution's component-driven principle.

## Complexity Tracking

*No constitution violations - this section left empty.*

---

## Phase 0: Research & Discovery

**Status**: Pending execution via `/spec-kitty.research` or research workflow

**Research Topics**:

1. **Tailwind 4 Dark Theme Implementation**
   - Topic: SF/Alien aesthetic using Tailwind 4 utilities
   - Rationale: FR-013 requires dark, industrial, futuristic styling
   - Questions: Custom color palette? Tailwind 4 CSS-in-JS patterns for theme consistency?

2. **vue-i18n Best Practices**
   - Topic: TypeScript-safe translation keys, locale detection, persistence
   - Rationale: FR-015, FR-016, FR-017, FR-018 require robust i18n
   - Questions: Type-safe translation keys? Browser locale detection fallback strategy?

3. **localStorage Best Practices for Vue 3**
   - Topic: Reactive localStorage sync, error handling (quota exceeded), concurrent tab behavior
   - Rationale: FR-008, FR-018 require persistent state, edge cases identified in spec
   - Questions: Watch vs manual save patterns? StorageEvent for cross-tab sync?

4. **Component Testing Strategies for Composition API**
   - Topic: Testing composables with Vitest, component tests with @vue/test-utils
   - Rationale: Constitution requires unit + component tests
   - Questions: Mock localStorage? Test reactivity and side effects?

**Outputs**: `research.md` with decisions, rationale, and alternatives considered for each topic.

---

## Phase 1: Design & Contracts

**Status**: Pending (after Phase 0 research completion)

### Phase 1A: Data Model

**File**: `data-model.md`

**Entities**:

1. **Character**
   - **Fields**: `name: string`, `stress: number`
   - **Constraints**: `name` required (non-empty), `stress` ≥ 0 (no upper limit per Alien RPG rules)
   - **Storage**: localStorage key `character`, JSON serialized
   - **Lifecycle**: Created on first name entry, updated on stress changes, reset when name edited

2. **ActionLogEntry**
   - **Fields**: `timestamp: string` (HH:MM format), `action: 'increment' | 'decrement' | 'reset'`, `resultingStress: number`
   - **Constraints**: `timestamp` ISO time string (localized to HH:MM for display), `action` enum, `resultingStress` ≥ 0
   - **Storage**: In-memory only (session-scoped, not persisted)
   - **Lifecycle**: Entries appended on stress manipulation, cleared on character name change or app reload

3. **LanguagePreference**
   - **Fields**: `locale: 'en' | 'fr'`
   - **Constraints**: Must be one of supported locales
   - **Storage**: localStorage key `languagePreference`, string value
   - **Lifecycle**: Defaults to browser locale (or 'en'), updated on selector change, persists across sessions

### Phase 1B: Contracts (TypeScript Interfaces)

**File**: `contracts/types.ts`

```typescript
// Core domain types
export interface Character {
  name: string
  stress: number
}

export type ActionType = 'increment' | 'decrement' | 'reset'

export interface ActionLogEntry {
  timestamp: string // ISO format for storage, display as HH:MM
  action: ActionType
  resultingStress: number
}

export type Locale = 'en' | 'fr'

// Composable return types
export interface UseCharacterStateReturn {
  character: Ref<Character>
  updateName: (newName: string) => void
  incrementStress: () => void
  decrementStress: () => void
  resetStress: () => void
}

export interface UseActionLogReturn {
  entries: Readonly<Ref<ActionLogEntry[]>>
  logAction: (action: ActionType, resultingStress: number) => void
  clearLog: () => void
}

export interface UseLocalStorageReturn<T> {
  storedValue: Ref<T>
  setStoredValue: (value: T) => void
  error: Readonly<Ref<Error | null>>
}
```

### Phase 1C: Quickstart Guide

**File**: `quickstart.md`

**Purpose**: End-user guide for using the stress tracker

**Content**:
1. **Getting Started**: Open app, enter character name, stress counter appears
2. **Tracking Stress**: Click +/- icons to adjust, reset button to clear
3. **Changing Characters**: Click character name to edit, stress resets automatically
4. **Viewing History**: Click history icon to toggle action log
5. **Changing Language**: Select French/English from dropdown

---

## Phase 2: Task Breakdown

**Status**: Deferred to `/spec-kitty.tasks` command

Tasks will be organized by user story priority (P1: Core Tracking → P2: Persistence → P3: Action Log) with language selector integrated into P1.

---

## Next Steps

1. ✅ **Planning complete** - Technical context and constitution check validated
2. ⏭️ **Run `/spec-kitty.research`** to scaffold research.md and answer open design questions
3. ⏭️ **Generate design artifacts** (data-model.md, contracts/types.ts, quickstart.md)
4. ⏭️ **Run `/spec-kitty.tasks`** to break down into work packages
5. ⏭️ **Run `/spec-kitty.implement`** to execute implementation

**Critical Path**: Phase 0 research → Phase 1 design → Task breakdown → Implementation
