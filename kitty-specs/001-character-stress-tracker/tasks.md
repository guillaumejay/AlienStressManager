---
description: "Work package task list for Character Stress Tracker implementation"
---
*Path: [kitty-specs/001-character-stress-tracker/tasks.md](kitty-specs/001-character-stress-tracker/tasks.md)*

# Work Packages: Character Stress Tracker

**Inputs**: Design documents from `/kitty-specs/001-character-stress-tracker/`
**Prerequisites**: plan.md (required), spec.md (user stories), research.md, data-model.md, contracts/, quickstart.md

**Tests**: Testing tasks included per constitution requirements (unit + component tests)

**Organization**: Fine-grained subtasks (`Txxx`) roll up into work packages (`WPxx`). Each work package must be independently deliverable and testable.

**Prompt Files**: Each work package references a matching prompt file in `/tasks/planned/` generated by `/spec-kitty.tasks`. Treat this file as the high-level checklist; keep deep implementation detail inside the prompt files.

## Subtask Format: `[Txxx] [P?] Description`
- **[P]** indicates the subtask can proceed in parallel (different files/components).
- Include precise file paths or modules.

## Path Conventions
- **Single project**: `src/`, `tests/`
- All paths relative to repository root (worktree root for this feature)

---

## Work Package WP01: Setup & Foundation (Priority: P0)

**Goal**: Establish project structure, Tailwind 4 theming, i18n configuration, and shared TypeScript types.
**Independent Test**: Project builds without errors, Tailwind theme variables accessible, i18n loads both locales.
**Prompt**: `/tasks/planned/WP01-setup-and-foundation.md`

### Included Subtasks
- [x] T001 [P] Create directory structure (`src/components/`, `src/composables/`, `src/i18n/`, `src/types/`, `tests/unit/`, `tests/components/`)
- [x] T002 [P] Setup Tailwind 4 theme with SF/Alien color palette in `src/style.css`
- [x] T003 [P] Create shared TypeScript types in `src/types/index.ts` (Character, ActionLogEntry, Locale, ActionType)
- [x] T004 [P] Setup i18n configuration in `src/i18n/index.ts` with browser locale detection
- [x] T005 [P] Create English translations in `src/i18n/locales/en.json`
- [x] T006 [P] Create French translations in `src/i18n/locales/fr.json`
- [x] T007 Update `src/main.ts` to integrate i18n plugin
- [x] T008 Update `src/App.vue` to apply Tailwind theme classes

### Implementation Notes
- T002: Define CSS custom properties using Tailwind 4 `@theme` directive per research.md
  - Colors: `--color-alien-bg-primary: #0a0e14`, `--color-alien-accent: #2d8f5f`, etc.
- T003: Copy type definitions from `contracts/types.ts` as starting point
- T004: Implement locale detection fallback chain: localStorage â†’ navigator.language â†’ 'en'
- T005-T006: Structure translations matching research.md example (app.title, app.characterName, app.actions.*, app.actionLog.*, app.language.*)

### Parallel Opportunities
- T001-T006 can all be completed in parallel (different files/concerns)
- T007-T008 sequential after i18n/theming setup complete

### Dependencies
- None (starting package)

### Risks & Mitigations
- **Risk**: Tailwind 4 CSS variable syntax incompatibility
  - **Mitigation**: Follow research.md pattern exactly, test with `bg-[var(--color-alien-bg-primary)]` utility

---

## Work Package WP02: Core Composables (Priority: P0)

**Goal**: Implement reusable composables for localStorage persistence, character state management, and action logging.
**Independent Test**: Each composable exports correct interface, passes unit tests, handles edge cases (quota exceeded, invalid data).
**Prompt**: `/tasks/planned/WP02-core-composables.md`

### Included Subtasks
- [x] T009 [P] Implement `useLocalStorage<T>` composable in `src/composables/useLocalStorage.ts`
- [x] T010 [P] Write unit tests for `useLocalStorage` in `tests/unit/useLocalStorage.spec.ts`
- [x] T011 Implement `useCharacterState` composable in `src/composables/useCharacterState.ts` (depends on T009)
- [x] T012 [P] Write unit tests for `useCharacterState` in `tests/unit/useCharacterState.spec.ts`
- [x] T013 [P] Implement `useActionLog` composable in `src/composables/useActionLog.ts`
- [x] T014 [P] Write unit tests for `useActionLog` in `tests/unit/useActionLog.spec.ts`
- [x] T015 Implement `useI18n` composable wrapper in `src/composables/useI18n.ts` (depends on T009)
- [x] T016 [P] Write unit tests for `useI18n` in `tests/unit/useI18n.spec.ts`

### Implementation Notes
- **T009**: Implement pattern from research.md
  - `watchEffect` for reactive localStorage writes
  - Try/catch for QuotaExceededError
  - StorageEvent listener for cross-tab sync
  - Return `{ storedValue, setStoredValue, error }`
- **T010**: Test scenarios:
  - Initial load from localStorage
  - Reactive updates trigger write
  - QuotaExceededError handling
  - Cross-tab sync via StorageEvent
  - Mock localStorage in beforeEach/afterEach
- **T011**: Integrate useLocalStorage, implement character CRUD
  - Persist to localStorage key 'character'
  - updateName() â†’ reset stress to 0 + clear action log
  - incrementStress(), decrementStress() (clamp to 0), resetStress()
- **T012**: Test all CRUD operations, stress clamping, name change triggers reset
- **T013**: Session-only in-memory array, no persistence
  - logAction(action, resultingStress) â†’ append entry with timestamp
  - clearLog() for name change
  - entries in reverse chronological order
- **T014**: Test log creation, timestamp format, reverse ordering, clear functionality
- **T015**: Wrap vue-i18n `useI18n()`, add `setLocale()` that persists to localStorage
- **T016**: Test locale switching, persistence, browser locale detection fallback

### Parallel Opportunities
- T009+T010, T013+T014 can proceed in parallel (independent composables)
- T011+T012, T015+T016 depend on useLocalStorage being complete

### Dependencies
- Depends on WP01 (types, i18n config, directory structure)

### Risks & Mitigations
- **Risk**: localStorage quota exceeded in tests
  - **Mitigation**: Mock localStorage, verify error handling without filling actual quota
- **Risk**: watchEffect triggers too frequently
  - **Mitigation**: Use Vue's batching, test performance with rapid updates

---

## Work Package WP03: User Story 1 â€“ Core Stress Tracking (Priority: P1) ðŸŽ¯ MVP

**Goal**: Implement character name input, stress counter display, and +/-/reset controls with SF/Alien theming and i18n support.
**Independent Test**: User can enter name, increment/decrement/reset stress, see live counter updates, switch language selector.
**Prompt**: `/tasks/planned/WP03-user-story-1-core-stress-tracking.md`

### Included Subtasks
- [x] T017 [P] Create `StressTracker.vue` component in `src/components/StressTracker.vue`
- [x] T018 [P] Create `LanguageSelector.vue` component in `src/components/LanguageSelector.vue`
- [x] T019 Integrate `StressTracker` and `LanguageSelector` into `src/App.vue`
- [x] T020 [P] Implement character name input with blur-based submission (FR-001, FR-002)
- [x] T021 [P] Implement stress counter display (FR-003)
- [x] T022 [P] Implement increment button with icon (FR-004)
- [x] T023 [P] Implement decrement button with icon (FR-005)
- [x] T024 [P] Implement reset button with icon (FR-006)
- [x] T025 [P] Apply SF/Alien Tailwind theming to all UI elements (FR-013)
- [x] T026 [P] Implement responsive layout (mobile 320px, tablet 768px, desktop 1024px+) (FR-014)
- [x] T027 [P] Wire language selector to change i18n locale (FR-016, FR-017)
- [x] T028 [P] Write component test for `StressTracker.vue` in `tests/components/StressTracker.spec.ts`
- [x] T029 [P] Write component test for `LanguageSelector.vue` in `tests/components/LanguageSelector.spec.ts`

### Implementation Notes
- **T017**: Use `useCharacterState` composable for state, `useI18n` for translations
  - Character name: editable text field, always visible (FR-002)
  - On blur: save name, show stress tracker (if name non-empty)
- **T018**: Dropdown with 'en' and 'fr' options
  - Bind to `locale` from `useI18n`, emit `setLocale` on change
  - Use `$t('app.language.en')` for option labels
- **T019**: Render LanguageSelector at top, StressTracker below
- **T020**: `<input type="text" @blur="handleNameSubmit">` pattern
  - Require non-empty name before showing stress controls (FR-001)
- **T021**: Large, prominent stress counter using Tailwind typography utilities
- **T022-T024**: Icon buttons (recommend Heroicons or Lucide)
  - Increment: Plus icon
  - Decrement: Minus icon
  - Reset: Circular arrow or refresh icon
  - Add ARIA labels for accessibility: `aria-label="Increment stress"`
- **T025**: Apply CSS variables: `bg-[var(--color-alien-bg-primary)]`, `text-[var(--color-alien-text)]`
  - Buttons: `bg-[var(--color-alien-accent)] hover:brightness-110`
- **T026**: Use Tailwind responsive modifiers: `flex flex-col md:flex-row`, `text-2xl md:text-4xl`
- **T027**: `<select v-model="locale" @change="setLocale">` with option elements
- **T028**: Test user interactions
  - Enter name â†’ stress counter appears
  - Click +/- â†’ counter updates
  - Click reset â†’ stress returns to 0
  - Edit name â†’ stress resets to 0
- **T029**: Test language switching updates UI text

### Parallel Opportunities
- T017+T018 can be developed in parallel (different components)
- T020-T024 can be implemented in parallel within StressTracker component
- T025-T027 layer on top after base functionality
- T028+T029 can run in parallel after components complete

### Dependencies
- Depends on WP02 (composables: useCharacterState, useI18n)

### Risks & Mitigations
- **Risk**: Icon library not chosen yet
  - **Mitigation**: Recommend Heroicons (MIT license, Tailwind ecosystem), defer to implementer if alternative preferred
- **Risk**: Responsive breakpoints not tested
  - **Mitigation**: Manual test at 320px, 768px, 1024px+ during implementation, use browser DevTools responsive mode

---

## Work Package WP04: User Story 2 â€“ State Persistence (Priority: P2)

**Goal**: Ensure character name, stress level, and language preference persist across browser sessions via localStorage.
**Independent Test**: Set character to "Ripley" stress 7 language 'fr', reload browser, verify all values restored.
**Prompt**: `/tasks/planned/WP04-user-story-2-state-persistence.md`

### Included Subtasks
- [x] T030 Verify `useCharacterState` persists to localStorage on every change (already implemented in WP02, validation task)
- [x] T031 Verify `useI18n` persists locale to localStorage on setLocale() (already implemented in WP02, validation task)
- [x] T032 Add error handling UI for localStorage unavailable scenario (edge case from spec)
- [x] T033 [P] Test persistence scenarios: create character â†’ reload â†’ verify state restored
- [x] T034 [P] Test edge case: edit character name â†’ verify stress resets to 0 and persists
- [x] T035 [P] Test edge case: change language â†’ reload â†’ verify language persists independently

### Implementation Notes
- **T030-T031**: Validation tasks - composables already persist via `useLocalStorage` from WP02
  - Review composable implementation, ensure localStorage writes occur on state changes
- **T032**: Add UI warning in App.vue if localStorage unavailable
  - Check `error` ref from `useLocalStorage`, display warning banner
  - Message: "Warning: Data will not be saved. Enable localStorage or use regular browsing mode."
- **T033-T035**: Component tests or manual QA scenarios
  - Use Vitest + @vue/test-utils to mock localStorage and verify persistence logic
  - Manual browser testing: private browsing mode, quota exceeded simulation

### Parallel Opportunities
- T032 independent from T033-T035
- T033-T035 can be tested in parallel (different scenarios)

### Dependencies
- Depends on WP02 (useLocalStorage, useCharacterState, useI18n composables)
- Depends on WP03 (StressTracker and LanguageSelector components)

### Risks & Mitigations
- **Risk**: Cross-tab sync conflicts (last-write-wins acceptable per spec)
  - **Mitigation**: StorageEvent listener in useLocalStorage handles sync (already in research pattern)
- **Risk**: localStorage quota exceeded
  - **Mitigation**: Character + locale data minimal (<1KB), unlikely to hit quota; error handling displays warning

---

## Work Package WP05: User Story 3 â€“ Action History Log (Priority: P3)

**Goal**: Implement toggle-able action log showing timestamped stress changes in reverse chronological order.
**Independent Test**: Perform stress actions, toggle log visible, verify entries show timestamps (HH:MM) and actions, hide log, verify unobtrusive placement.
**Prompt**: `/tasks/planned/WP05-user-story-3-action-history-log.md`

### Included Subtasks
- [x] T036 [P] Create `ActionLog.vue` component in `src/components/ActionLog.vue`
- [x] T037 [P] Implement toggle button in StressTracker for showing/hiding log (FR-011)
- [x] T038 Integrate `useActionLog` composable into `ActionLog.vue`
- [x] T039 [P] Display log entries with timestamp (HH:MM format) and action description (FR-010, FR-012)
- [x] T040 [P] Implement reverse chronological ordering (newest first) per clarifications
- [x] T041 [P] Apply unobtrusive styling (collapsible panel, hidden by default)
- [x] T042 Wire action log to stress manipulation events (increment/decrement/reset)
- [x] T043 Implement log clear on character name change (edge case from spec)
- [x] T044 [P] Write component test for `ActionLog.vue` in `tests/components/ActionLog.spec.ts`

### Implementation Notes
- **T036**: Accept props: `entries: ActionLogEntry[]`, `isVisible: boolean`
  - Emit 'toggle' event for parent to handle visibility
- **T037**: Icon button (e.g., list or history icon) in StressTracker header
  - Toggle boolean state, pass to ActionLog component
- **T038**: Call `useActionLog()`, destructure `entries`, `logAction`, `clearLog`
- **T039**: Format timestamp: `new Date(entry.timestamp).toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })`
  - Display action: "+1", "-1", "Reset to 0" based on entry.action
- **T040**: `entries` already in reverse order from composable (array push + reverse render)
- **T041**: Use Tailwind: `transition-all duration-300`, `max-h-0 overflow-hidden` when hidden, `max-h-96` when visible
  - Position below stress controls, non-intrusive (e.g., bottom of screen or slide-in panel)
- **T042**: In StressTracker, call `logAction(action, character.value.stress)` after each increment/decrement/reset
- **T043**: In StressTracker `updateName()` handler, call `clearLog()` from `useActionLog`
- **T044**: Test toggle visibility, log entry display, timestamp formatting, action descriptions

### Parallel Opportunities
- T036+T037 can proceed in parallel (component creation + toggle button)
- T039-T041 can be implemented in parallel within ActionLog component
- T044 independent after component complete

### Dependencies
- Depends on WP02 (useActionLog composable)
- Depends on WP03 (StressTracker component to integrate toggle + wire events)

### Risks & Mitigations
- **Risk**: Log entries grow unbounded in memory during long sessions
  - **Mitigation**: Session-scoped only (clears on reload), acceptable per spec; could add max entries limit (e.g., 100) if needed
- **Risk**: Timestamp display inconsistent across locales
  - **Mitigation**: Use explicit format options in `toLocaleTimeString`, test in both English and French locales

---

## Work Package WP06: Polish & Cross-Cutting (Priority: P4)

**Goal**: Type checking, linting, accessibility audit, responsive testing, and final QA across all user stories.
**Independent Test**: All tests pass (`npm run test:unit`), type-check passes, lint passes, manual QA checklist complete.
**Prompt**: `/tasks/planned/WP06-polish-and-cross-cutting.md`

### Included Subtasks
- [x] T045 [P] Run type-check (`npm run type-check`) and fix any TypeScript errors
- [x] T046 [P] Run linting (`npm run lint`) and fix any ESLint/oxlint violations
- [x] T047 [P] Run formatting (`npm run format`) to ensure code style consistency
- [x] T048 [P] Accessibility audit: verify all icon buttons have `aria-label`, keyboard navigation works
- [x] T049 [P] Responsive testing: manually test at 320px, 768px, 1024px+ viewports
- [x] T050 [P] Cross-browser testing: test in Chrome, Firefox, Safari (if available)
- [x] T051 [P] Performance check: verify bundle size <500KB, initial load <3s on 3G simulation
- [x] T052 Manual QA: validate all acceptance scenarios from spec.md
- [x] T053 [P] Update README with quickstart instructions (link to quickstart.md)
- [x] T054 Final review: validate all functional requirements (FR-001 through FR-018) met

### Implementation Notes
- **T045**: Run `npm run type-check`, address any errors
  - Ensure no `any` types without justification comments
- **T046**: Run `npm run lint`, fix warnings
  - Both oxlint (correctness) and ESLint (style) must pass
- **T047**: Run `npm run format` on `src/` directory
- **T048**: ARIA labels required:
  - Increment button: `aria-label="Increment stress"`
  - Decrement button: `aria-label="Decrement stress"`
  - Reset button: `aria-label="Reset stress to zero"`
  - Action log toggle: `aria-label="Toggle action history"`
  - Language selector: `<label for="language-select">` + `id="language-select"` on select element
  - Test keyboard navigation: Tab through all controls, Enter/Space activate buttons
- **T049**: Use browser DevTools responsive mode
  - Test 320px: UI remains functional, no horizontal scroll
  - Test 768px: Layout adapts (e.g., side-by-side elements if designed)
  - Test 1024px+: Desktop layout, optimal spacing
- **T050**: Chrome (primary), Firefox (secondary), Safari (if macOS available)
  - Verify localStorage works, CSS variables render, i18n switching works
- **T051**: Use Vite build (`npm run build`), check `dist/` bundle size
  - Network throttling in DevTools: Slow 3G simulation, measure load time
- **T052**: Walk through all acceptance scenarios from spec.md User Stories 1-3
  - Check off each "Given/When/Then" scenario
- **T053**: Add "Quick Start" section to README.md linking to quickstart.md
- **T054**: Final checklist audit against all 18 functional requirements

### Parallel Opportunities
- T045-T047 can run in parallel (different tools)
- T048-T051 can proceed in parallel (different validation types)
- T052-T054 sequential (final validation steps)

### Dependencies
- Depends on WP03, WP04, WP05 (all user stories implemented)

### Risks & Mitigations
- **Risk**: Type check failures due to missing types
  - **Mitigation**: Explicit type annotations required from WP01 onward, catch early
- **Risk**: Accessibility violations found late
  - **Mitigation**: Address ARIA labels during component implementation (WP03, WP05), not just in polish phase

---

## Dependency & Execution Summary

**Sequence**:
1. WP01 (Setup & Foundation) â†’ foundational types, theming, i18n
2. WP02 (Core Composables) â†’ reusable business logic
3. WP03 (User Story 1 - Core Tracking) ðŸŽ¯ **MVP MILESTONE**
4. WP04 (User Story 2 - Persistence) â†’ enhances MVP with state survival
5. WP05 (User Story 3 - Action Log) â†’ optional audit feature
6. WP06 (Polish & Cross-Cutting) â†’ QA and final validation

**Parallelization**:
- WP01: All setup tasks (T001-T006) can run in parallel
- WP02: Composable pairs (T009+T010, T013+T014) can run in parallel after useLocalStorage
- WP03: Component creation (T017+T018) parallel, subtask features (T020-T024) parallel
- WP05: ActionLog component (T036) and toggle button (T037) parallel
- WP06: All validation tasks (T045-T051) can run in parallel

**MVP Scope**: WP01 + WP02 + WP03 = Core stress tracking with theming and i18n
- Delivers FR-001 through FR-017 (excludes action log from FR-010)
- User can track stress, switch languages, persist state
- Minimum viable product for Alien RPG play sessions

---

## Subtask Index (Reference)

| Subtask ID | Summary | Work Package | Priority | Parallel? |
|------------|---------|--------------|----------|-----------|
| T001 | Create directory structure | WP01 | P0 | Yes |
| T002 | Setup Tailwind 4 theme | WP01 | P0 | Yes |
| T003 | Create shared TypeScript types | WP01 | P0 | Yes |
| T004 | Setup i18n configuration | WP01 | P0 | Yes |
| T005 | Create English translations | WP01 | P0 | Yes |
| T006 | Create French translations | WP01 | P0 | Yes |
| T007 | Integrate i18n in main.ts | WP01 | P0 | No |
| T008 | Apply theme in App.vue | WP01 | P0 | No |
| T009 | Implement useLocalStorage composable | WP02 | P0 | Yes |
| T010 | Test useLocalStorage | WP02 | P0 | Yes |
| T011 | Implement useCharacterState composable | WP02 | P0 | No |
| T012 | Test useCharacterState | WP02 | P0 | Yes |
| T013 | Implement useActionLog composable | WP02 | P0 | Yes |
| T014 | Test useActionLog | WP02 | P0 | Yes |
| T015 | Implement useI18n composable | WP02 | P0 | No |
| T016 | Test useI18n | WP02 | P0 | Yes |
| T017 | Create StressTracker component | WP03 | P1 | Yes |
| T018 | Create LanguageSelector component | WP03 | P1 | Yes |
| T019 | Integrate components in App.vue | WP03 | P1 | No |
| T020 | Implement character name input | WP03 | P1 | Yes |
| T021 | Implement stress counter display | WP03 | P1 | Yes |
| T022 | Implement increment button | WP03 | P1 | Yes |
| T023 | Implement decrement button | WP03 | P1 | Yes |
| T024 | Implement reset button | WP03 | P1 | Yes |
| T025 | Apply SF/Alien theming | WP03 | P1 | Yes |
| T026 | Implement responsive layout | WP03 | P1 | Yes |
| T027 | Wire language selector | WP03 | P1 | Yes |
| T028 | Test StressTracker component | WP03 | P1 | Yes |
| T029 | Test LanguageSelector component | WP03 | P1 | Yes |
| T030 | Verify character state persistence | WP04 | P2 | No |
| T031 | Verify locale persistence | WP04 | P2 | No |
| T032 | Add localStorage error handling UI | WP04 | P2 | Yes |
| T033 | Test persistence scenarios | WP04 | P2 | Yes |
| T034 | Test name change persistence | WP04 | P2 | Yes |
| T035 | Test language persistence | WP04 | P2 | Yes |
| T036 | Create ActionLog component | WP05 | P3 | Yes |
| T037 | Implement log toggle button | WP05 | P3 | Yes |
| T038 | Integrate useActionLog composable | WP05 | P3 | No |
| T039 | Display log entries with timestamps | WP05 | P3 | Yes |
| T040 | Implement reverse chronological order | WP05 | P3 | Yes |
| T041 | Apply unobtrusive styling | WP05 | P3 | Yes |
| T042 | Wire log to stress events | WP05 | P3 | No |
| T043 | Implement log clear on name change | WP05 | P3 | No |
| T044 | Test ActionLog component | WP05 | P3 | Yes |
| T045 | Run type-check | WP06 | P4 | Yes |
| T046 | Run linting | WP06 | P4 | Yes |
| T047 | Run formatting | WP06 | P4 | Yes |
| T048 | Accessibility audit | WP06 | P4 | Yes |
| T049 | Responsive testing | WP06 | P4 | Yes |
| T050 | Cross-browser testing | WP06 | P4 | Yes |
| T051 | Performance check | WP06 | P4 | Yes |
| T052 | Manual QA scenarios | WP06 | P4 | No |
| T053 | Update README | WP06 | P4 | Yes |
| T054 | Final FR validation | WP06 | P4 | No |

**Total Subtasks**: 54
**Total Work Packages**: 6
**Parallel Opportunities**: 35 subtasks marked [P] can proceed in parallel within their work package context

---

> This task breakdown provides the complete implementation roadmap for the Character Stress Tracker feature. Each work package has a dedicated prompt file in `/tasks/planned/` with detailed implementation guidance.
